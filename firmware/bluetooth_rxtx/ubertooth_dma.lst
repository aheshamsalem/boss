ARM GAS  /var/folders/s6/4bph2j8d1nvcsgz5bgm0yhx00000gn/T//ccg0vPMB.s 			page 1


   1              		.syntax unified
   2              		.cpu cortex-m3
   3              		.fpu softvfp
   4              		.eabi_attribute 20, 1
   5              		.eabi_attribute 21, 1
   6              		.eabi_attribute 23, 3
   7              		.eabi_attribute 24, 1
   8              		.eabi_attribute 25, 1
   9              		.eabi_attribute 26, 1
  10              		.eabi_attribute 30, 4
  11              		.eabi_attribute 34, 1
  12              		.eabi_attribute 18, 4
  13              		.thumb
  14              		.file	"ubertooth_dma.c"
  15              		.text
  16              	.Ltext0:
  17              		.cfi_sections	.debug_frame
  18              		.section	.text.dma_disable,"ax",%progbits
  19              		.align	1
  20              		.thumb
  21              		.thumb_func
  23              	dma_disable:
  24              	.LFB1:
  25              		.file 1 "ubertooth_dma.c"
   1:ubertooth_dma.c **** /*
   2:ubertooth_dma.c ****  * Copyright 2015 Hannes Ellinger
   3:ubertooth_dma.c ****  *
   4:ubertooth_dma.c ****  * This file is part of Project Ubertooth.
   5:ubertooth_dma.c ****  *
   6:ubertooth_dma.c ****  * This program is free software; you can redistribute it and/or modify
   7:ubertooth_dma.c ****  * it under the terms of the GNU General Public License as published by
   8:ubertooth_dma.c ****  * the Free Software Foundation; either version 2, or (at your option)
   9:ubertooth_dma.c ****  * any later version.
  10:ubertooth_dma.c ****  *
  11:ubertooth_dma.c ****  * This program is distributed in the hope that it will be useful,
  12:ubertooth_dma.c ****  * but WITHOUT ANY WARRANTY; without even the implied warranty of
  13:ubertooth_dma.c ****  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  14:ubertooth_dma.c ****  * GNU General Public License for more details.
  15:ubertooth_dma.c ****  *
  16:ubertooth_dma.c ****  * You should have received a copy of the GNU General Public License
  17:ubertooth_dma.c ****  * along with this program; see the file COPYING.  If not, write to
  18:ubertooth_dma.c ****  * the Free Software Foundation, Inc., 51 Franklin Street,
  19:ubertooth_dma.c ****  * Boston, MA 02110-1301, USA.
  20:ubertooth_dma.c ****  */
  21:ubertooth_dma.c **** 
  22:ubertooth_dma.c **** #include "ubertooth_dma.h"
  23:ubertooth_dma.c **** 
  24:ubertooth_dma.c **** /* DMA linked list items */
  25:ubertooth_dma.c **** typedef struct {
  26:ubertooth_dma.c **** 	uint32_t src;
  27:ubertooth_dma.c **** 	uint32_t dest;
  28:ubertooth_dma.c **** 	uint32_t next_lli;
  29:ubertooth_dma.c **** 	uint32_t control;
  30:ubertooth_dma.c **** } dma_lli;
  31:ubertooth_dma.c **** 
  32:ubertooth_dma.c **** dma_lli rx_dma_lli1;
  33:ubertooth_dma.c **** dma_lli rx_dma_lli2;
ARM GAS  /var/folders/s6/4bph2j8d1nvcsgz5bgm0yhx00000gn/T//ccg0vPMB.s 			page 2


  34:ubertooth_dma.c **** 
  35:ubertooth_dma.c **** dma_lli le_dma_lli[11]; // 11 x 4 bytes
  36:ubertooth_dma.c **** 
  37:ubertooth_dma.c **** 
  38:ubertooth_dma.c **** static void dma_enable(void)
  39:ubertooth_dma.c **** {
  40:ubertooth_dma.c **** 	/* enable DMA */
  41:ubertooth_dma.c **** 	DMACC0Config |= DMACCxConfig_E;
  42:ubertooth_dma.c **** 	ISER0 = ISER0_ISE_DMA;
  43:ubertooth_dma.c **** }
  44:ubertooth_dma.c **** 
  45:ubertooth_dma.c **** static void dma_disable(void)
  46:ubertooth_dma.c **** {
  26              		.loc 1 46 0
  27              		.cfi_startproc
  28              		@ args = 0, pretend = 0, frame = 0
  29              		@ frame_needed = 0, uses_anonymous_args = 0
  30              		@ link register save eliminated.
  47:ubertooth_dma.c **** 	// disable DMA engine:
  48:ubertooth_dma.c **** 	// refer to UM10360 LPC17xx User Manual Ch 31 Sec 31.6.1, PDF page 607
  49:ubertooth_dma.c **** 
  50:ubertooth_dma.c **** 	// disable DMA interrupts
  51:ubertooth_dma.c **** 	ICER0 = ICER0_ICE_DMA;
  31              		.loc 1 51 0
  32 0000 154B     		ldr	r3, .L5
  33 0002 4FF08062 		mov	r2, #67108864
  34 0006 1A60     		str	r2, [r3]
  52:ubertooth_dma.c **** 
  53:ubertooth_dma.c **** 	// disable active channels
  54:ubertooth_dma.c **** 	DMACC0Config = 0;
  35              		.loc 1 54 0
  36 0008 144A     		ldr	r2, .L5+4
  37 000a 0023     		movs	r3, #0
  38 000c 1360     		str	r3, [r2]
  55:ubertooth_dma.c **** 	DMACC1Config = 0;
  39              		.loc 1 55 0
  40 000e 1362     		str	r3, [r2, #32]
  56:ubertooth_dma.c **** 	DMACC2Config = 0;
  41              		.loc 1 56 0
  42 0010 1364     		str	r3, [r2, #64]
  57:ubertooth_dma.c **** 	DMACC3Config = 0;
  43              		.loc 1 57 0
  44 0012 1366     		str	r3, [r2, #96]
  58:ubertooth_dma.c **** 	DMACC4Config = 0;
  45              		.loc 1 58 0
  46 0014 C2F88030 		str	r3, [r2, #128]
  59:ubertooth_dma.c **** 	DMACC5Config = 0;
  47              		.loc 1 59 0
  48 0018 C2F8A030 		str	r3, [r2, #160]
  60:ubertooth_dma.c **** 	DMACC6Config = 0;
  49              		.loc 1 60 0
  50 001c C2F8C030 		str	r3, [r2, #192]
  61:ubertooth_dma.c **** 	DMACC7Config = 0;
  51              		.loc 1 61 0
  52 0020 C2F8E030 		str	r3, [r2, #224]
  62:ubertooth_dma.c **** 	DMACIntTCClear = 0xFF;
  53              		.loc 1 62 0
ARM GAS  /var/folders/s6/4bph2j8d1nvcsgz5bgm0yhx00000gn/T//ccg0vPMB.s 			page 3


  54 0024 FF23     		movs	r3, #255
  55 0026 A2F58472 		sub	r2, r2, #264
  56 002a 1360     		str	r3, [r2]
  63:ubertooth_dma.c **** 	DMACIntErrClr = 0xFF;
  57              		.loc 1 63 0
  58 002c 9360     		str	r3, [r2, #8]
  64:ubertooth_dma.c **** 
  65:ubertooth_dma.c **** 	// Disable the DMA controller by writing 0 to the DMA Enable bit in the DMACConfig
  66:ubertooth_dma.c **** 	// register.
  67:ubertooth_dma.c **** 	DMACConfig &= ~DMACConfig_E;
  59              		.loc 1 67 0
  60 002e 0C4B     		ldr	r3, .L5+8
  61 0030 1A68     		ldr	r2, [r3]
  62 0032 22F00102 		bic	r2, r2, #1
  63 0036 1A60     		str	r2, [r3]
  64 0038 1A46     		mov	r2, r3
  65              	.L2:
  68:ubertooth_dma.c **** 	while (DMACConfig & DMACConfig_E);
  66              		.loc 1 68 0 discriminator 1
  67 003a 1368     		ldr	r3, [r2]
  68 003c 13F00103 		ands	r3, r3, #1
  69 0040 FBD1     		bne	.L2
  69:ubertooth_dma.c **** 
  70:ubertooth_dma.c **** 	/* reset interrupt counters */
  71:ubertooth_dma.c **** 	rx_tc = 0;
  70              		.loc 1 71 0
  71 0042 084A     		ldr	r2, .L5+12
  72 0044 1360     		str	r3, [r2]
  72:ubertooth_dma.c **** 	rx_err = 0;
  73              		.loc 1 72 0
  74 0046 084A     		ldr	r2, .L5+16
  75 0048 1360     		str	r3, [r2]
  73:ubertooth_dma.c **** 
  74:ubertooth_dma.c **** 	active_rxbuf = &rxbuf1[0];
  76              		.loc 1 74 0
  77 004a 084A     		ldr	r2, .L5+20
  78 004c 084B     		ldr	r3, .L5+24
  79 004e 1A60     		str	r2, [r3]
  75:ubertooth_dma.c **** 	idle_rxbuf = &rxbuf2[0];
  80              		.loc 1 75 0
  81 0050 084A     		ldr	r2, .L5+28
  82 0052 094B     		ldr	r3, .L5+32
  83 0054 1A60     		str	r2, [r3]
  84 0056 7047     		bx	lr
  85              	.L6:
  86              		.align	2
  87              	.L5:
  88 0058 80E100E0 		.word	-536813184
  89 005c 10410050 		.word	1342193936
  90 0060 30400050 		.word	1342193712
  91 0064 00000000 		.word	rx_tc
  92 0068 00000000 		.word	rx_err
  93 006c 00000000 		.word	rxbuf1
  94 0070 00000000 		.word	active_rxbuf
  95 0074 00000000 		.word	rxbuf2
  96 0078 00000000 		.word	idle_rxbuf
  97              		.cfi_endproc
ARM GAS  /var/folders/s6/4bph2j8d1nvcsgz5bgm0yhx00000gn/T//ccg0vPMB.s 			page 4


  98              	.LFE1:
 100              		.section	.text.dma_init,"ax",%progbits
 101              		.align	1
 102              		.global	dma_init
 103              		.thumb
 104              		.thumb_func
 106              	dma_init:
 107              	.LFB2:
  76:ubertooth_dma.c **** }
  77:ubertooth_dma.c **** 
  78:ubertooth_dma.c **** void dma_init()
  79:ubertooth_dma.c **** {
 108              		.loc 1 79 0
 109              		.cfi_startproc
 110              		@ args = 0, pretend = 0, frame = 0
 111              		@ frame_needed = 0, uses_anonymous_args = 0
 112 0000 08B5     		push	{r3, lr}
 113              		.cfi_def_cfa_offset 8
 114              		.cfi_offset 3, -8
 115              		.cfi_offset 14, -4
  80:ubertooth_dma.c **** 	/* power up GPDMA controller */
  81:ubertooth_dma.c **** 	PCONP |= PCONP_PCGPDMA;
 116              		.loc 1 81 0
 117 0002 144A     		ldr	r2, .L11
 118 0004 1368     		ldr	r3, [r2]
 119 0006 43F00053 		orr	r3, r3, #536870912
 120 000a 1360     		str	r3, [r2]
  82:ubertooth_dma.c **** 
  83:ubertooth_dma.c **** 	dma_disable();
 121              		.loc 1 83 0
 122 000c FFF7FEFF 		bl	dma_disable
 123              	.LVL0:
  84:ubertooth_dma.c **** 
  85:ubertooth_dma.c **** 	/* DMA linked lists */
  86:ubertooth_dma.c **** 	rx_dma_lli1.src = (uint32_t)&(DIO_SSP_DR);
 124              		.loc 1 86 0
 125 0010 114B     		ldr	r3, .L11+4
  87:ubertooth_dma.c **** 	rx_dma_lli1.dest = (uint32_t)&rxbuf1[0];
 126              		.loc 1 87 0
 127 0012 124A     		ldr	r2, .L11+8
  86:ubertooth_dma.c **** 	rx_dma_lli1.dest = (uint32_t)&rxbuf1[0];
 128              		.loc 1 86 0
 129 0014 1248     		ldr	r0, .L11+12
 130              		.loc 1 87 0
 131 0016 5A60     		str	r2, [r3, #4]
  88:ubertooth_dma.c **** 	rx_dma_lli1.next_lli = (uint32_t)&rx_dma_lli2;
 132              		.loc 1 88 0
 133 0018 124A     		ldr	r2, .L11+16
  89:ubertooth_dma.c **** 	rx_dma_lli1.control = (DMA_SIZE) |
 134              		.loc 1 89 0
 135 001a 1349     		ldr	r1, .L11+20
  90:ubertooth_dma.c **** 			(1 << 12) |        /* source burst size = 4 */
  91:ubertooth_dma.c **** 			(1 << 15) |        /* destination burst size = 4 */
  92:ubertooth_dma.c **** 			(0 << 18) |        /* source width 8 bits */
  93:ubertooth_dma.c **** 			(0 << 21) |        /* destination width 8 bits */
  94:ubertooth_dma.c **** 			DMACCxControl_DI | /* destination increment */
  95:ubertooth_dma.c **** 			DMACCxControl_I;   /* terminal count interrupt enable */
ARM GAS  /var/folders/s6/4bph2j8d1nvcsgz5bgm0yhx00000gn/T//ccg0vPMB.s 			page 5


  96:ubertooth_dma.c **** 
  97:ubertooth_dma.c **** 	rx_dma_lli2.src = (uint32_t)&(DIO_SSP_DR);
 136              		.loc 1 97 0
 137 001c 1060     		str	r0, [r2]
  86:ubertooth_dma.c **** 	rx_dma_lli1.dest = (uint32_t)&rxbuf1[0];
 138              		.loc 1 86 0
 139 001e 1860     		str	r0, [r3]
  98:ubertooth_dma.c **** 	rx_dma_lli2.dest = (uint32_t)&rxbuf2[0];
 140              		.loc 1 98 0
 141 0020 1248     		ldr	r0, .L11+24
  88:ubertooth_dma.c **** 	rx_dma_lli1.control = (DMA_SIZE) |
 142              		.loc 1 88 0
 143 0022 9A60     		str	r2, [r3, #8]
  99:ubertooth_dma.c **** 	rx_dma_lli2.next_lli = (uint32_t)&rx_dma_lli1;
 100:ubertooth_dma.c **** 	rx_dma_lli2.control = (DMA_SIZE) |
 144              		.loc 1 100 0
 145 0024 D160     		str	r1, [r2, #12]
  98:ubertooth_dma.c **** 	rx_dma_lli2.next_lli = (uint32_t)&rx_dma_lli1;
 146              		.loc 1 98 0
 147 0026 5060     		str	r0, [r2, #4]
  99:ubertooth_dma.c **** 	rx_dma_lli2.next_lli = (uint32_t)&rx_dma_lli1;
 148              		.loc 1 99 0
 149 0028 9360     		str	r3, [r2, #8]
 101:ubertooth_dma.c **** 			(1 << 12) |        /* source burst size = 4 */
 102:ubertooth_dma.c **** 			(1 << 15) |        /* destination burst size = 4 */
 103:ubertooth_dma.c **** 			(0 << 18) |        /* source width 8 bits */
 104:ubertooth_dma.c **** 			(0 << 21) |        /* destination width 8 bits */
 105:ubertooth_dma.c **** 			DMACCxControl_DI | /* destination increment */
 106:ubertooth_dma.c **** 			DMACCxControl_I;   /* terminal count interrupt enable */
 107:ubertooth_dma.c **** 
 108:ubertooth_dma.c **** 	/* enable DMA globally */
 109:ubertooth_dma.c **** 	DMACConfig = DMACConfig_E;
 150              		.loc 1 109 0
 151 002a 114A     		ldr	r2, .L11+28
  89:ubertooth_dma.c **** 			(1 << 12) |        /* source burst size = 4 */
 152              		.loc 1 89 0
 153 002c D960     		str	r1, [r3, #12]
 154              		.loc 1 109 0
 155 002e 0121     		movs	r1, #1
 156 0030 1160     		str	r1, [r2]
 157              	.L8:
 110:ubertooth_dma.c **** 	while (!(DMACConfig & DMACConfig_E));
 158              		.loc 1 110 0 discriminator 1
 159 0032 1168     		ldr	r1, [r2]
 160 0034 C907     		lsls	r1, r1, #31
 161 0036 FCD5     		bpl	.L8
 111:ubertooth_dma.c **** 
 112:ubertooth_dma.c **** 	/* configure DMA channel 1 */
 113:ubertooth_dma.c **** 	DMACC0SrcAddr = rx_dma_lli1.src;
 162              		.loc 1 113 0
 163 0038 1968     		ldr	r1, [r3]
 164 003a 0E4A     		ldr	r2, .L11+32
 165 003c 1160     		str	r1, [r2]
 114:ubertooth_dma.c **** 	DMACC0DestAddr = rx_dma_lli1.dest;
 166              		.loc 1 114 0
 167 003e 5968     		ldr	r1, [r3, #4]
 168 0040 5160     		str	r1, [r2, #4]
ARM GAS  /var/folders/s6/4bph2j8d1nvcsgz5bgm0yhx00000gn/T//ccg0vPMB.s 			page 6


 115:ubertooth_dma.c **** 	DMACC0LLI = rx_dma_lli1.next_lli;
 169              		.loc 1 115 0
 170 0042 9968     		ldr	r1, [r3, #8]
 171 0044 9160     		str	r1, [r2, #8]
 116:ubertooth_dma.c **** 	DMACC0Control = rx_dma_lli1.control;
 172              		.loc 1 116 0
 173 0046 DA68     		ldr	r2, [r3, #12]
 174 0048 0B4B     		ldr	r3, .L11+36
 175 004a 1A60     		str	r2, [r3]
 117:ubertooth_dma.c **** 	DMACC0Config = DIO_SSP_SRC
 176              		.loc 1 117 0
 177 004c 4DF20602 		movw	r2, #53254
 178 0050 5A60     		str	r2, [r3, #4]
 179 0052 08BD     		pop	{r3, pc}
 180              	.L12:
 181              		.align	2
 182              	.L11:
 183 0054 C4C00F40 		.word	1074774212
 184 0058 00000000 		.word	rx_dma_lli1
 185 005c 00000000 		.word	rxbuf1
 186 0060 08000340 		.word	1073938440
 187 0064 00000000 		.word	rx_dma_lli2
 188 0068 32900088 		.word	-2013229006
 189 006c 00000000 		.word	rxbuf2
 190 0070 30400050 		.word	1342193712
 191 0074 00410050 		.word	1342193920
 192 0078 0C410050 		.word	1342193932
 193              		.cfi_endproc
 194              	.LFE2:
 196              		.section	.text.dma_init_le,"ax",%progbits
 197              		.align	1
 198              		.global	dma_init_le
 199              		.thumb
 200              		.thumb_func
 202              	dma_init_le:
 203              	.LFB3:
 118:ubertooth_dma.c **** 	               | (0x2 << 11)       /* peripheral to memory */
 119:ubertooth_dma.c **** 	               | DMACCxConfig_IE   /* allow error interrupts */
 120:ubertooth_dma.c **** 	               | DMACCxConfig_ITC; /* allow terminal count interrupts */
 121:ubertooth_dma.c **** }
 122:ubertooth_dma.c **** 
 123:ubertooth_dma.c **** void dma_init_le()
 124:ubertooth_dma.c **** {
 204              		.loc 1 124 0
 205              		.cfi_startproc
 206              		@ args = 0, pretend = 0, frame = 0
 207              		@ frame_needed = 0, uses_anonymous_args = 0
 208 0000 08B5     		push	{r3, lr}
 209              		.cfi_def_cfa_offset 8
 210              		.cfi_offset 3, -8
 211              		.cfi_offset 14, -4
 125:ubertooth_dma.c **** 	int i;
 126:ubertooth_dma.c **** 
 127:ubertooth_dma.c **** 	/* power up GPDMA controller */
 128:ubertooth_dma.c **** 	PCONP |= PCONP_PCGPDMA;
 212              		.loc 1 128 0
 213 0002 1A4A     		ldr	r2, .L21
ARM GAS  /var/folders/s6/4bph2j8d1nvcsgz5bgm0yhx00000gn/T//ccg0vPMB.s 			page 7


 214 0004 1368     		ldr	r3, [r2]
 215 0006 43F00053 		orr	r3, r3, #536870912
 216 000a 1360     		str	r3, [r2]
 129:ubertooth_dma.c **** 
 130:ubertooth_dma.c **** 	dma_disable();
 217              		.loc 1 130 0
 218 000c FFF7FEFF 		bl	dma_disable
 219              	.LVL1:
 131:ubertooth_dma.c **** 
 132:ubertooth_dma.c **** 	/* enable DMA globally */
 133:ubertooth_dma.c **** 	DMACConfig = DMACConfig_E;
 220              		.loc 1 133 0
 221 0010 174B     		ldr	r3, .L21+4
 222 0012 0122     		movs	r2, #1
 223 0014 1A60     		str	r2, [r3]
 224              	.L14:
 134:ubertooth_dma.c **** 	while (!(DMACConfig & DMACConfig_E));
 225              		.loc 1 134 0 discriminator 1
 226 0016 1A68     		ldr	r2, [r3]
 227 0018 D207     		lsls	r2, r2, #31
 228 001a FCD5     		bpl	.L14
 229 001c 154B     		ldr	r3, .L21+8
 230              		.loc 1 134 0 is_stmt 0
 231 001e 0022     		movs	r2, #0
 232              	.L16:
 233              	.LVL2:
 135:ubertooth_dma.c **** 
 136:ubertooth_dma.c **** 	for (i = 0; i < 11; ++i) {
 137:ubertooth_dma.c **** 		le_dma_lli[i].src = (uint32_t)&(DIO_SSP_DR);
 234              		.loc 1 137 0 is_stmt 1
 235 0020 1549     		ldr	r1, .L21+12
 138:ubertooth_dma.c **** 		le_dma_lli[i].dest = (uint32_t)&rxbuf1[4 * i];
 139:ubertooth_dma.c **** 		le_dma_lli[i].next_lli = i < 10 ? (uint32_t)&le_dma_lli[i+1] : 0;
 236              		.loc 1 139 0
 237 0022 0A2A     		cmp	r2, #10
 137:ubertooth_dma.c **** 		le_dma_lli[i].dest = (uint32_t)&rxbuf1[4 * i];
 238              		.loc 1 137 0
 239 0024 43F8101C 		str	r1, [r3, #-16]
 240 0028 1449     		ldr	r1, .L21+16
 241 002a 01EB8201 		add	r1, r1, r2, lsl #2
 138:ubertooth_dma.c **** 		le_dma_lli[i].dest = (uint32_t)&rxbuf1[4 * i];
 242              		.loc 1 138 0
 243 002e 43F80C1C 		str	r1, [r3, #-12]
 244              		.loc 1 139 0
 245 0032 14BF     		ite	ne
 246 0034 1946     		movne	r1, r3
 247 0036 0021     		moveq	r1, #0
 248 0038 43F8081C 		str	r1, [r3, #-8]
 136:ubertooth_dma.c **** 		le_dma_lli[i].src = (uint32_t)&(DIO_SSP_DR);
 249              		.loc 1 136 0
 250 003c 0132     		adds	r2, r2, #1
 251              	.LVL3:
 140:ubertooth_dma.c **** 		le_dma_lli[i].control = 4 |
 252              		.loc 1 140 0
 253 003e 1049     		ldr	r1, .L21+20
 136:ubertooth_dma.c **** 		le_dma_lli[i].src = (uint32_t)&(DIO_SSP_DR);
 254              		.loc 1 136 0
ARM GAS  /var/folders/s6/4bph2j8d1nvcsgz5bgm0yhx00000gn/T//ccg0vPMB.s 			page 8


 255 0040 0B2A     		cmp	r2, #11
 256              		.loc 1 140 0
 257 0042 43F8041C 		str	r1, [r3, #-4]
 258 0046 03F11003 		add	r3, r3, #16
 136:ubertooth_dma.c **** 		le_dma_lli[i].src = (uint32_t)&(DIO_SSP_DR);
 259              		.loc 1 136 0
 260 004a E9D1     		bne	.L16
 261              	.LVL4:
 141:ubertooth_dma.c **** 				(1 << 12) |        /* source burst size = 4 */
 142:ubertooth_dma.c **** 				(0 << 15) |        /* destination burst size = 1 */
 143:ubertooth_dma.c **** 				(0 << 18) |        /* source width 8 bits */
 144:ubertooth_dma.c **** 				(0 << 21) |        /* destination width 8 bits */
 145:ubertooth_dma.c **** 				DMACCxControl_DI | /* destination increment */
 146:ubertooth_dma.c **** 				DMACCxControl_I;   /* terminal count interrupt enable */
 147:ubertooth_dma.c **** 	}
 148:ubertooth_dma.c **** 
 149:ubertooth_dma.c **** 	/* configure DMA channel 0 */
 150:ubertooth_dma.c **** 	DMACC0SrcAddr = le_dma_lli[0].src;
 262              		.loc 1 150 0
 263 004c 0D4B     		ldr	r3, .L21+24
 264 004e 0E4A     		ldr	r2, .L21+28
 265 0050 1968     		ldr	r1, [r3]
 266 0052 1160     		str	r1, [r2]
 151:ubertooth_dma.c **** 	DMACC0DestAddr = le_dma_lli[0].dest;
 267              		.loc 1 151 0
 268 0054 5968     		ldr	r1, [r3, #4]
 269 0056 5160     		str	r1, [r2, #4]
 152:ubertooth_dma.c **** 	DMACC0LLI = le_dma_lli[0].next_lli;
 270              		.loc 1 152 0
 271 0058 9968     		ldr	r1, [r3, #8]
 272 005a 9160     		str	r1, [r2, #8]
 153:ubertooth_dma.c **** 	DMACC0Control = le_dma_lli[0].control;
 273              		.loc 1 153 0
 274 005c DA68     		ldr	r2, [r3, #12]
 275 005e 0B4B     		ldr	r3, .L21+32
 276 0060 1A60     		str	r2, [r3]
 154:ubertooth_dma.c **** 	DMACC0Config =
 277              		.loc 1 154 0
 278 0062 4DF20602 		movw	r2, #53254
 279 0066 5A60     		str	r2, [r3, #4]
 280 0068 08BD     		pop	{r3, pc}
 281              	.L22:
 282 006a 00BF     		.align	2
 283              	.L21:
 284 006c C4C00F40 		.word	1074774212
 285 0070 30400050 		.word	1342193712
 286 0074 10000000 		.word	le_dma_lli+16
 287 0078 08000340 		.word	1073938440
 288 007c 00000000 		.word	rxbuf1
 289 0080 04100088 		.word	-2013261820
 290 0084 00000000 		.word	le_dma_lli
 291 0088 00410050 		.word	1342193920
 292 008c 0C410050 		.word	1342193932
 293              		.cfi_endproc
 294              	.LFE3:
 296              		.section	.text.dio_ssp_start,"ax",%progbits
 297              		.align	1
ARM GAS  /var/folders/s6/4bph2j8d1nvcsgz5bgm0yhx00000gn/T//ccg0vPMB.s 			page 9


 298              		.global	dio_ssp_start
 299              		.thumb
 300              		.thumb_func
 302              	dio_ssp_start:
 303              	.LFB4:
 155:ubertooth_dma.c **** 			DIO_SSP_SRC |
 156:ubertooth_dma.c **** 			(0x2 << 11) |     /* peripheral to memory */
 157:ubertooth_dma.c **** 			DMACCxConfig_IE | /* allow error interrupts */
 158:ubertooth_dma.c **** 			DMACCxConfig_ITC; /* allow terminal count interrupts */
 159:ubertooth_dma.c **** }
 160:ubertooth_dma.c **** 
 161:ubertooth_dma.c **** 
 162:ubertooth_dma.c **** void dio_ssp_start()
 163:ubertooth_dma.c **** {
 304              		.loc 1 163 0
 305              		.cfi_startproc
 306              		@ args = 0, pretend = 0, frame = 0
 307              		@ frame_needed = 0, uses_anonymous_args = 0
 308              		@ link register save eliminated.
 164:ubertooth_dma.c **** 	/* make sure the (active low) slave select signal is not active */
 165:ubertooth_dma.c **** 	DIO_SSEL_SET;
 309              		.loc 1 165 0
 310 0000 0D4B     		ldr	r3, .L24
 166:ubertooth_dma.c **** 
 167:ubertooth_dma.c **** 	/* enable rx DMA on DIO_SSP */
 168:ubertooth_dma.c **** 	DIO_SSP_DMACR |= SSPDMACR_RXDMAE;
 311              		.loc 1 168 0
 312 0002 0E49     		ldr	r1, .L24+4
 165:ubertooth_dma.c **** 
 313              		.loc 1 165 0
 314 0004 4FF08052 		mov	r2, #268435456
 315 0008 1A60     		str	r2, [r3]
 316              		.loc 1 168 0
 317 000a 0B68     		ldr	r3, [r1]
 318 000c 43F00103 		orr	r3, r3, #1
 319 0010 0B60     		str	r3, [r1]
 169:ubertooth_dma.c **** 	DIO_SSP_CR1 |= SSPCR1_SSE;
 320              		.loc 1 169 0
 321 0012 51F8203C 		ldr	r3, [r1, #-32]
 322 0016 43F00203 		orr	r3, r3, #2
 323 001a 41F8203C 		str	r3, [r1, #-32]
 324              	.LBB4:
 325              	.LBB5:
  41:ubertooth_dma.c **** 	ISER0 = ISER0_ISE_DMA;
 326              		.loc 1 41 0
 327 001e 0849     		ldr	r1, .L24+8
 328 0020 0B68     		ldr	r3, [r1]
 329 0022 43F00103 		orr	r3, r3, #1
 330 0026 0B60     		str	r3, [r1]
  42:ubertooth_dma.c **** }
 331              		.loc 1 42 0
 332 0028 064B     		ldr	r3, .L24+12
 333 002a 4FF08061 		mov	r1, #67108864
 334 002e 1960     		str	r1, [r3]
 335              	.LBE5:
 336              	.LBE4:
 170:ubertooth_dma.c **** 
ARM GAS  /var/folders/s6/4bph2j8d1nvcsgz5bgm0yhx00000gn/T//ccg0vPMB.s 			page 10


 171:ubertooth_dma.c **** 	dma_enable();
 172:ubertooth_dma.c **** 
 173:ubertooth_dma.c **** 	/* activate slave select pin */
 174:ubertooth_dma.c **** 	DIO_SSEL_CLR;
 337              		.loc 1 174 0
 338 0030 054B     		ldr	r3, .L24+16
 339 0032 1A60     		str	r2, [r3]
 340 0034 7047     		bx	lr
 341              	.L25:
 342 0036 00BF     		.align	2
 343              	.L24:
 344 0038 98C00920 		.word	537510040
 345 003c 24000340 		.word	1073938468
 346 0040 10410050 		.word	1342193936
 347 0044 00E100E0 		.word	-536813312
 348 0048 9CC00920 		.word	537510044
 349              		.cfi_endproc
 350              	.LFE4:
 352              		.section	.text.dio_ssp_stop,"ax",%progbits
 353              		.align	1
 354              		.global	dio_ssp_stop
 355              		.thumb
 356              		.thumb_func
 358              	dio_ssp_stop:
 359              	.LFB5:
 175:ubertooth_dma.c **** }
 176:ubertooth_dma.c **** 
 177:ubertooth_dma.c **** void dio_ssp_stop()
 178:ubertooth_dma.c **** {
 360              		.loc 1 178 0
 361              		.cfi_startproc
 362              		@ args = 0, pretend = 0, frame = 0
 363              		@ frame_needed = 0, uses_anonymous_args = 0
 364              		@ link register save eliminated.
 179:ubertooth_dma.c **** 	// disable CC2400's output (active low)
 180:ubertooth_dma.c **** 	DIO_SSEL_SET;
 365              		.loc 1 180 0
 366 0000 084B     		ldr	r3, .L27
 367 0002 4FF08052 		mov	r2, #268435456
 368 0006 1A60     		str	r2, [r3]
 181:ubertooth_dma.c **** 
 182:ubertooth_dma.c **** 	// disable DMA on SSP; disable SSP
 183:ubertooth_dma.c **** 	DIO_SSP_DMACR &= ~SSPDMACR_RXDMAE;
 369              		.loc 1 183 0
 370 0008 074A     		ldr	r2, .L27+4
 371 000a 1368     		ldr	r3, [r2]
 372 000c 23F00103 		bic	r3, r3, #1
 373 0010 1360     		str	r3, [r2]
 184:ubertooth_dma.c **** 	DIO_SSP_CR1 &= ~SSPCR1_SSE;
 374              		.loc 1 184 0
 375 0012 52F8203C 		ldr	r3, [r2, #-32]
 376 0016 23F00203 		bic	r3, r3, #2
 377 001a 42F8203C 		str	r3, [r2, #-32]
 185:ubertooth_dma.c **** 
 186:ubertooth_dma.c **** 	dma_disable();
 378              		.loc 1 186 0
 379 001e FFF7FEBF 		b	dma_disable
ARM GAS  /var/folders/s6/4bph2j8d1nvcsgz5bgm0yhx00000gn/T//ccg0vPMB.s 			page 11


 380              	.LVL5:
 381              	.L28:
 382 0022 00BF     		.align	2
 383              	.L27:
 384 0024 98C00920 		.word	537510040
 385 0028 24000340 		.word	1073938468
 386              		.cfi_endproc
 387              	.LFE5:
 389              		.comm	le_dma_lli,176,4
 390              		.comm	rx_dma_lli2,16,4
 391              		.comm	rx_dma_lli1,16,4
 392              		.comm	rx_err,4,4
 393              		.comm	rx_tc,4,4
 394              		.comm	idle_rxbuf,4,4
 395              		.comm	active_rxbuf,4,4
 396              		.comm	rxbuf2,50,1
 397              		.comm	rxbuf1,50,1
 398              		.text
 399              	.Letext0:
 400              		.file 2 "/Users/ahesham/research/Bluetooth/boss/uberCode/gcc-arm-none-eabi/lib/gcc/arm-none-eabi/4
 401              		.file 3 "ubertooth_dma.h"
ARM GAS  /var/folders/s6/4bph2j8d1nvcsgz5bgm0yhx00000gn/T//ccg0vPMB.s 			page 12


DEFINED SYMBOLS
                            *ABS*:0000000000000000 ubertooth_dma.c
/var/folders/s6/4bph2j8d1nvcsgz5bgm0yhx00000gn/T//ccg0vPMB.s:19     .text.dma_disable:0000000000000000 $t
/var/folders/s6/4bph2j8d1nvcsgz5bgm0yhx00000gn/T//ccg0vPMB.s:23     .text.dma_disable:0000000000000000 dma_disable
/var/folders/s6/4bph2j8d1nvcsgz5bgm0yhx00000gn/T//ccg0vPMB.s:88     .text.dma_disable:0000000000000058 $d
                            *COM*:0000000000000004 rx_tc
                            *COM*:0000000000000004 rx_err
                            *COM*:0000000000000032 rxbuf1
                            *COM*:0000000000000004 active_rxbuf
                            *COM*:0000000000000032 rxbuf2
                            *COM*:0000000000000004 idle_rxbuf
/var/folders/s6/4bph2j8d1nvcsgz5bgm0yhx00000gn/T//ccg0vPMB.s:101    .text.dma_init:0000000000000000 $t
/var/folders/s6/4bph2j8d1nvcsgz5bgm0yhx00000gn/T//ccg0vPMB.s:106    .text.dma_init:0000000000000000 dma_init
/var/folders/s6/4bph2j8d1nvcsgz5bgm0yhx00000gn/T//ccg0vPMB.s:183    .text.dma_init:0000000000000054 $d
                            *COM*:0000000000000010 rx_dma_lli1
                            *COM*:0000000000000010 rx_dma_lli2
/var/folders/s6/4bph2j8d1nvcsgz5bgm0yhx00000gn/T//ccg0vPMB.s:197    .text.dma_init_le:0000000000000000 $t
/var/folders/s6/4bph2j8d1nvcsgz5bgm0yhx00000gn/T//ccg0vPMB.s:202    .text.dma_init_le:0000000000000000 dma_init_le
/var/folders/s6/4bph2j8d1nvcsgz5bgm0yhx00000gn/T//ccg0vPMB.s:284    .text.dma_init_le:000000000000006c $d
                            *COM*:00000000000000b0 le_dma_lli
/var/folders/s6/4bph2j8d1nvcsgz5bgm0yhx00000gn/T//ccg0vPMB.s:297    .text.dio_ssp_start:0000000000000000 $t
/var/folders/s6/4bph2j8d1nvcsgz5bgm0yhx00000gn/T//ccg0vPMB.s:302    .text.dio_ssp_start:0000000000000000 dio_ssp_start
/var/folders/s6/4bph2j8d1nvcsgz5bgm0yhx00000gn/T//ccg0vPMB.s:344    .text.dio_ssp_start:0000000000000038 $d
/var/folders/s6/4bph2j8d1nvcsgz5bgm0yhx00000gn/T//ccg0vPMB.s:353    .text.dio_ssp_stop:0000000000000000 $t
/var/folders/s6/4bph2j8d1nvcsgz5bgm0yhx00000gn/T//ccg0vPMB.s:358    .text.dio_ssp_stop:0000000000000000 dio_ssp_stop
/var/folders/s6/4bph2j8d1nvcsgz5bgm0yhx00000gn/T//ccg0vPMB.s:384    .text.dio_ssp_stop:0000000000000024 $d
                     .debug_frame:0000000000000010 $d

NO UNDEFINED SYMBOLS
